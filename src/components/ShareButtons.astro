---
import { ui, defaultLang } from '../i18n/ui';

interface Props {
  title: string;
  slug: string;
  lang: keyof typeof ui;
}

const { title, slug, lang } = Astro.props;
const t = ui[lang] ?? ui[defaultLang];

const url = `https://brainnoises.com/blog/${slug}/`;
const encodedUrl = encodeURIComponent(url);
const encodedTitle = encodeURIComponent(title);

const shareLinks = {
  twitter: `https://x.com/intent/tweet?url=${encodedUrl}&text=${encodedTitle}`,
  facebook: `https://www.facebook.com/sharer/sharer.php?u=${encodedUrl}`,
  linkedin: `https://www.linkedin.com/shareArticle?mini=true&url=${encodedUrl}&title=${encodedTitle}`,
  whatsapp: `https://api.whatsapp.com/send?text=${encodedTitle}%20${encodedUrl}`,
  telegram: `https://t.me/share/url?url=${encodedUrl}&text=${encodedTitle}`,
  reddit: `https://www.reddit.com/submit?url=${encodedUrl}&title=${encodedTitle}`,
};
---

<div class="share-container">
  <h3>{t['share.title']}</h3>
  <div class="share-buttons">
    <a href={shareLinks.twitter} target="_blank" rel="noopener noreferrer" class="share-button" aria-label={t['share.twitter']}>
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor"><path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"/></svg>
    </a>
    <a href={shareLinks.facebook} target="_blank" rel="noopener noreferrer" class="share-button" aria-label={t['share.facebook']}>
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M18 2h-3a5 5 0 0 0-5 5v3H7v4h3v8h4v-8h3l1-4h-4V7a1 1 0 0 1 1-1h3z"></path></svg>
    </a>
    <a href={shareLinks.linkedin} target="_blank" rel="noopener noreferrer" class="share-button" aria-label={t['share.linkedin']}>
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M16 8a6 6 0 0 1 6 6v7h-4v-7a2 2 0 0 0-2-2 2 2 0 0 0-2 2v7h-4v-7a6 6 0 0 1 6-6z"></path><rect x="2" y="9" width="4" height="12"></rect><circle cx="4" cy="4" r="2"></circle></svg>
    </a>
    <a href={shareLinks.whatsapp} target="_blank" rel="noopener noreferrer" class="share-button" aria-label={t['share.whatsapp']}>
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z"></path></svg>
    </a>
    <a href={shareLinks.telegram} target="_blank" rel="noopener noreferrer" class="share-button" aria-label={t['share.telegram']}>
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M22 2 11 13"></path><path d="M22 2 15 22 11 13 2 9z"></path></svg>
    </a>
    <a href={shareLinks.reddit} target="_blank" rel="noopener noreferrer" class="share-button" aria-label={t['share.reddit']}>
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor"><path d="M14.238 15.348c.085.084.085.221 0 .306-.465.462-1.194.687-2.231.687l-.008-.002-.008.002c-1.036 0-1.766-.225-2.231-.688-.085-.084-.085-.221 0-.305.084-.084.222-.084.307 0 .379.377 1.008.561 1.924.561l.008.002.008-.002c.915 0 1.544-.184 1.924-.561.085-.084.223-.084.307 0zm-3.44-2.418c0-.507-.414-.919-.922-.919-.509 0-.923.412-.923.919 0 .506.414.918.923.918.508.001.922-.411.922-.918zm13.202-.93c0 6.627-5.373 12-12 12s-12-5.373-12-12 5.373-12 12-12 12 5.373 12 12zm-5-.129c0-.851-.695-1.543-1.55-1.543-.417 0-.795.167-1.074.435-1.056-.695-2.485-1.137-4.066-1.194l.865-2.724 2.343.549-.003.034c0 .696.569 1.262 1.268 1.262.699 0 1.267-.566 1.267-1.262s-.568-1.262-1.267-1.262c-.537 0-.994.335-1.179.804l-2.525-.592c-.11-.027-.223.037-.257.145l-.965 3.038c-1.656.02-3.155.466-4.258 1.181-.277-.255-.644-.415-1.05-.415-.854.001-1.549.693-1.549 1.544 0 .566.311 1.056.768 1.325-.03.164-.05.331-.05.5 0 2.281 2.805 4.137 6.253 4.137s6.253-1.856 6.253-4.137c0-.16-.017-.317-.044-.472.486-.261.82-.766.82-1.353zm-4.872.141c-.509 0-.922.412-.922.919 0 .506.414.918.922.918s.922-.412.922-.918c0-.507-.413-.919-.922-.919z"/></svg>
    </a>
    <button id="copy-link-button" class="share-button" aria-label={t['share.copy']}>
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
    </button>
  </div>
  <div id="copy-link-feedback" class="feedback-message" aria-live="polite"></div>
</div>

<script define:vars={{ t }}>
  const copyButton = document.getElementById('copy-link-button');
  const feedbackMessage = document.getElementById('copy-link-feedback');
  
  copyButton.addEventListener('click', () => {
    navigator.clipboard.writeText(window.location.href).then(() => {
      feedbackMessage.textContent = t['share.copied'];
      setTimeout(() => {
        feedbackMessage.textContent = '';
      }, 2000);
    });
  });
</script>

<style>
  .share-container {
    margin: 2rem 0;
    text-align: center;
  }
  .share-container h3 {
    margin-bottom: 1rem;
    font-size: 1.2rem;
    color: rgb(var(--black));
  }
  .share-buttons {
    display: flex;
    justify-content: center;
    gap: 1rem;
  }
  .share-button {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    width: 40px;
    height: 40px;
    border-radius: 50%;
    background-color: transparent;
    border: 1px solid rgb(var(--gray));
    color: rgb(var(--gray));
    transition: all 0.3s ease;
  }
  .share-button:hover {
    background-color: rgb(var(--gray));
    color: #000000;
    transform: scale(1.1);
  }
  .feedback-message {
    margin-top: 1rem;
    color: var(--green);
    font-weight: bold;
    height: 1.2em;
  }
</style>